<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Now</title>
  <link href="https://fonts.googleapis.com/css2?family=Castoro+Titling&display=swap" rel="stylesheet">
  <style>
    :root{
      --about-fs-min: 10;     /* px */
      --about-fs-max: 32;     /* px */
      --about-line: 1.22;
      --about-pad-y: 0.15em;
      --about-pad-x: 0.25em;

      --brand-yellow: rgb(255,255,0);
      --brand-orange: rgb(255,140,0);
      --glow-orange: rgba(255,140,0,0.6);
    }

    html, body { margin: 0; padding: 0; height: 100%; background: black; }
    .container { position: relative; height: 100vh; width: 100vw; overflow: hidden; }

    /* Background video */
    video.bg { position: absolute; inset: 0; width: 100%; height: 100%; object-fit: cover; z-index: 0; }

    /* SFERA overlay */
    img.overlay {
      position: absolute; top: 0; left: 0; width: 100vw; height: auto;
      pointer-events: none; user-select: none; display: block; z-index: 1;
      transition: opacity .35s ease, visibility .35s ease, filter .35s ease, transform .35s ease;
    }
    /* Keep SFERA on About, blur it, and raise above about-bg but below text */
    body.is-about .overlay {
      z-index: 2;                 /* above .about-bg (1), below .about-layer (3) */
      filter: blur(10px);         /* <-- adjusted blur (less severe) */
      transform: scale(1.1);      /* hide blur edges */
      opacity: 1;
      visibility: visible;
    }

    /* Bottom GIF dock (hidden in About or Contact mode) */
    .gif-bar {
      position: absolute; left: 20px; right: 20px; bottom: 20px;
      display: flex; align-items: flex-end; justify-content: space-between; gap: 20px;
      z-index: 2; max-height: calc(100vh - 90px - 20px);
      transition: opacity .35s ease, visibility .35s ease, transform .35s ease;
    }
    .gif-card { position: relative; display: inline-block; text-align: center; }

    /* Make the GIF + label one link */
    .gif-link { position: relative; display: inline-block; text-decoration: none; }
    .gif-img {
      position: relative; display: block; height: auto; width: auto;
      max-width: min(22vw, 300px); max-height: 100%;
      image-rendering: -webkit-optimize-contrast; image-rendering: crisp-edges;
      margin: 0 auto; transition: transform .3s ease; z-index: 3;
      pointer-events: none; /* clicks go to the anchor wrapper */
    }
    .gif-label {
      position: absolute; bottom: 12px; left: 50%; transform: translateX(-50%);
      font-family: 'Castoro Titling', serif; font-size: 2.5rem;
      color: var(--brand-yellow); text-decoration: none; background: transparent;
      padding: 6px 20px; border-radius: 6px; z-index: 4;
      text-shadow: 0 2px 4px rgba(0,0,0,.5);
      pointer-events: none; /* entire card is already clickable via .gif-link */
    }

    /* Hover glow under GIFs */
    .glow-img {
      position: absolute; left: 50%; transform: translateX(-50%);
      bottom: 20px;
      max-width: 120%; pointer-events: none; opacity: 0; transition: opacity .3s ease;
      z-index: 2;
    }
    .gif-card:hover .glow-img,
    .gif-card:focus-within .glow-img { opacity: 1; }

    /* ABOUT mode background image */
    .about-bg {
      position: absolute; inset: 0; width: 100%; height: 100%;
      object-fit: cover; z-index: 1; opacity: 0; visibility: hidden; transition: opacity .4s ease, visibility .4s ease;
    }

    /* ABOUT text layer — fill screen, not centered grid */
    .about-layer {
      position: absolute; inset: 0; z-index: 3;
      opacity: 0; visibility: hidden; transition: opacity .4s ease, visibility .4s ease;
      pointer-events: none;
    }

    /* Fill the viewport and let JS size the text so it fits without scroll */
    .about-wrap {
      position: absolute; inset: 0;
      padding: 80px 16px 16px 16px; /* top reserves for BACK */
      box-sizing: border-box;

      font-family: 'Castoro Titling', serif;
      text-transform: uppercase;
      letter-spacing: 0.02em;
      color: #333333;

      font-size: var(--about-fs-max)px; /* default; JS will fit */
      line-height: var(--about-line);

      overflow: hidden;      /* no scroll – we always fit */
    }

    .about-wrap p {
      margin: 0 0 0.9em 0;
      text-align: left;
      hyphens: auto;
      -webkit-hyphens: auto;
    }

    /* Per-line white background strips hugging the text (remove background line to drop strips) */
    .about-wrap span.bg {
      background: #ffffff;
      padding: var(--about-pad-y) var(--about-pad-x);
      -webkit-box-decoration-break: clone; box-decoration-break: clone;
      line-height: inherit;
    }

    /* Back button — yellow text, no box, orange glow */
    .about-back,
    .contact-back {
      position: absolute; z-index: 5;
      font-family: 'Castoro Titling', serif; font-size: 1.35rem;
      color: var(--brand-yellow); background: transparent; border: none;
      padding: 6px 10px; text-decoration: none;
      text-shadow: 0 0 10px var(--glow-orange), 0 0 18px var(--glow-orange);
      box-shadow: none;
      transition: transform .15s ease, text-shadow .2s ease;
      pointer-events: auto;
    }
    .about-back { top: 14px; right: 16px; }
    .contact-back { right: 16px; bottom: 16px; }

    .about-back:hover, .contact-back:hover { transform: translateY(-1px); }
    .about-back:focus-visible, .contact-back:focus-visible {
      outline: none;
      text-shadow: 0 0 12px var(--glow-orange), 0 0 24px var(--glow-orange);
    }

    /* Contact layer */
    .contact-layer {
  position: absolute; inset: 0; z-index: 3;
  display: grid; place-items: center;
  opacity: 0; visibility: hidden; transition: opacity .35s ease, visibility .35s ease;
  pointer-events: none;
}
.contact-card {
  position: relative;
  width: 600px;                 /* bigger */
  max-width: 90vw;
  transform: translateY(200px); /* move down */
  display: grid; place-items: center;
}
.contact-img {
  width: 100%;
  height: auto;
  object-fit: contain;
  display: block;
  filter: drop-shadow(0 10px 30px rgba(0,0,0,.35));
}
.contact-email {
  position: absolute;
  inset: 0;
  display: grid; place-items: center;
  font-family: 'Castoro Titling', serif;
  font-size: clamp(18px, 3.2vw, 28px);
  color: var(--brand-orange);
  text-decoration: none;
  text-transform: none; /* allow mixed case */
  text-shadow:
    0 2px 10px rgba(0,0,0,.35),
    0 0 10px var(--brand-yellow),
    0 0 14px rgba(255,140,0,.4);
}

    /* Mode toggles */
    body.is-about .gif-bar,
    body.is-contact .gif-bar { opacity: 0; visibility: hidden; transform: translateY(10px); }
    body.is-about .about-bg   { opacity: 1; visibility: visible; }
    body.is-about .about-layer{ opacity: 1; visibility: visible; pointer-events: auto; }
    body.is-contact .contact-layer{ opacity: 1; visibility: visible; pointer-events: auto; }
  </style>
</head>
<body>
  <div class="container">
    <!-- Background stays visible in all modes -->
    <video class="bg" src="media/background.mp4" autoplay muted loop playsinline preload="auto" poster="media/poster.jpg"></video>

    <!-- Default overlay (also shows on About, blurred by CSS) -->
    <img class="overlay" src="media/SFERA.png" alt="Overlay image" />

    <!-- GIFs (hidden in About/Contact modes) -->
    <div class="gif-bar">
      <div class="gif-card left">
        <img class="glow-img" src="media/GLOW.png" alt="Glow" />
        <a href="#about" class="gif-link" id="aboutLink" aria-label="Open About">
          <img id="gifLeft" class="gif-img" src="media/output.gif" alt="Left animation" decoding="async" />
          <span class="gif-label">ABOUT</span>
        </a>
      </div>

      <div class="gif-card right">
        <img class="glow-img" src="media/GLOW.png" alt="Glow" />
        <a href="#contact" class="gif-link" id="contactLink" aria-label="Open Contact">
          <img id="gifRight" class="gif-img" src="media/output2.gif" alt="Right animation" decoding="async" />
          <span class="gif-label">CONTACT</span>
        </a>
      </div>
    </div>

    <!-- ABOUT mode background image -->
    <img class="about-bg" src="media/about.png" alt="About background" />

    <!-- ABOUT text layer -->
    <div class="about-layer" aria-hidden="true">
      <a href="#" class="about-back" id="aboutBack">BACK</a>
      <div class="about-wrap" role="dialog" aria-label="About Sfera" id="aboutWrap">
        <p><span class="bg">Sfera is a research-driven collective formed by Sylvia Rybak, Marco Winter, and Ula Sowa Przybylska, working across digital art, media theory, and immersive production. With backgrounds in photography, data science, cultural anthropology, and sound, their practices converge around the critical exploration of social and economic structures, speculative aesthetics, and technological mediation. They met during their studies, where they specialised in 3D game engines, and have since collaborated on digital environments and interaction aesthetics.</span></p>

        <p><span class="bg">Their current work spans themes such as hauntological aesthetics in video games, the cultural dissemination of systemic imaginaries, and immersive modes of storytelling. Sfera’s practice is grounded in interdisciplinary methods, drawing from theory, research, and technological experimentation to explore how digital tools shape collective imagination and political possibility.</span></p>

        <p><span class="bg">Sylvia Rybak, originally trained in photography, is a researcher and digital artist exploring hypothesised social and economic systems and their dissemination through blockchain, gaming, and internet cultures. Marco Winter brings together media theory, data science, and sound to investigate how affect and memory operate within the haunted architectures of digital play. Ula Sowa Przybylska, with a background in cultural anthropology and immersive media, is focused on narrative space and immersive storytelling.</span></p>
      </div>
    </div>

    <!-- CONTACT layer -->
    <div class="contact-layer" aria-hidden="true">
      <a href="#" class="contact-back" id="contactBack">BACK</a>
      <div class="contact-card" role="dialog" aria-label="Contact Sfera">
        <img class="contact-img" src="media/contact.png" alt="Contact graphic" />
        <a class="contact-email" href="mailto:sfera@email.com">sfera@email.com</a>
      </div>
    </div>

    <!-- GIF fallback loader + Mode toggles + Fit-text -->
    <script>
      (function(){
        function tryLoad(id, candidates){
          const el = document.getElementById(id); if (!el) return;
          const base = 'media/'; const cb = Date.now(); let i = 0;
          function next(){
            if (i >= candidates.length){ console.warn(id+': no candidate loaded'); return; }
            const url = base + candidates[i] + '?cb=' + cb; const test = new Image();
            test.onload = function(){ el.src = url; };
            test.onerror = function(){ i++; next(); };
            test.src = url;
          }
          const probe = new Image();
          probe.onerror = next; probe.src = el.src + '?cb=' + cb;
        }
        tryLoad('gifLeft',  ['output.gif','overlay.gif','animation.gif']);
        tryLoad('gifRight', ['output2.gif','overlay2.gif','animation2.gif']);
      })();

      (function(){
        const body = document.body;
        const aboutLink = document.getElementById('aboutLink');
        const contactLink = document.getElementById('contactLink');
        const aboutBack = document.getElementById('aboutBack');
        const contactBack = document.getElementById('contactBack');
        const aboutWrap = document.getElementById('aboutWrap');

        function clearModes() {
          body.classList.remove('is-about', 'is-contact');
        }

        function enterAbout(e){
          if (e) e.preventDefault();
          clearModes();
          body.classList.add('is-about');
          fitAbout();
        }
        function enterContact(e){
          if (e) e.preventDefault();
          clearModes();
          body.classList.add('is-contact');
        }
        function exitAll(e){
          if (e) e.preventDefault();
          clearModes();
        }

        if (aboutLink)   aboutLink.addEventListener('click', enterAbout);
        if (contactLink) contactLink.addEventListener('click', enterContact);
        if (aboutBack)   aboutBack.addEventListener('click', exitAll);
        if (contactBack) contactBack.addEventListener('click', exitAll);
        document.addEventListener('keydown', (e)=>{ if(e.key==='Escape') exitAll(); });

        /* ---- Fit-text algorithm: largest font-size that fits without scroll ---- */
        let pending = false;
        function fitAbout(){
          if (!aboutWrap || !body.classList.contains('is-about')) return;

          const rs = getComputedStyle(document.documentElement);
          const minFS = parseFloat(rs.getPropertyValue('--about-fs-min')) || 10;
          const maxFS = parseFloat(rs.getPropertyValue('--about-fs-max')) || 32;

          aboutWrap.style.lineHeight = rs.getPropertyValue('--about-line') || '1.22';

          let lo = minFS, hi = maxFS, mid = 0;
          const epsilon = 0.25;

          function fits(fs){
            aboutWrap.style.fontSize = fs + 'px';
            const fitsH = aboutWrap.scrollHeight <= aboutWrap.clientHeight + 1;
            const fitsW = aboutWrap.scrollWidth  <= aboutWrap.clientWidth  + 1;
            return fitsH && fitsW;
          }

          while (hi - lo > epsilon) {
            mid = (lo + hi) / 2;
            if (fits(mid)) lo = mid; else hi = mid;
          }
          aboutWrap.style.fontSize = lo + 'px';

          if (!fits(lo)) {
            let lh = parseFloat(getComputedStyle(aboutWrap).lineHeight) / parseFloat(getComputedStyle(aboutWrap).fontSize);
            while (!fits(lo) && lh > 1.05) {
              lh -= 0.02;
              aboutWrap.style.lineHeight = lh.toFixed(2);
            }
          }
        }

        const ro = new ResizeObserver(()=> {
          if (!body.classList.contains('is-about')) return;
          if (pending) return;
          pending = true;
          requestAnimationFrame(()=> { pending = false; fitAbout(); });
        });
        ro.observe(document.querySelector('.about-layer'));

        if (document.fonts && document.fonts.ready) {
          document.fonts.ready.then(()=> fitAbout());
        }
        window.addEventListener('orientationchange', fitAbout);
        window.addEventListener('resize', ()=> {
          if (!body.classList.contains('is-about')) return;
          fitAbout();
        }, { passive: true });
      })();
    </script>
  </div>
</body>
</html>
